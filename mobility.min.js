/**
 * Mobility - Mobility is a super light weight HTML, 
 * CSS, and JS framework built on top of Bootstrap 
 * for developing mobile applications. 
 *
 * @version 0.0.2
 * @author Christian Blanquera <cblanquera@openovate.com>
 * @website https://github.com/cblanquera/mobility
 * @license MIT
 */
!function(i){i(window).on("go-back-click",function(o){o.preventDefault();var e=t("go-back-click",o.target),s=n(e);try{i(s).length&&i(s).html()&&(i.mobility.swap(i(s).html(),"slide-right"),o.originalEvent.stop=!0)}catch(o){}i(window).trigger("mobility-request",[s,"slide-right"])}).on("go-forward-click",function(o){o.preventDefault();var e=t("go-back-click",o.target),s=n(e);try{i(s).length&&i(s).html()&&(i.mobility.swap(i(s).html(),"slide-left"),o.originalEvent.stop=!0)}catch(o){}i(window).trigger("mobility-request",[s,"slide-left"])}).on("focus-input-group-init",function(t,n){n=i(n),n.find("label").each(function(){i(this).click(function(){n.find("label input").each(function(){this.checked?i(this).parents("label:first").addClass("active"):i(this).parents("label:first").removeClass("active")})})})}).on("tab-switch-click",function(o){o.preventDefault(),o.originalEvent.stop=!0;var e=t("tab-switch-click",o.target),s=i(n(e));e.siblings().each(function(){var t=i(this).removeClass("active").attr("href");i(t).addClass("hide")}),e.addClass("active"),s.removeClass("hide")}).on("modal-open-click",function(o){if(o.preventDefault(),o.originalEvent.stop=!0,!i.mobility.busy){i.mobility.busy=!0;var e=t("modal-open-click",o.target),s=i(n(e)),a=function(){s.unbind("webkitTransitionEnd",a).removeClass("sliding"),i.mobility.busy=!1};s.addClass("sliding-down").removeClass("hide"),s[0].offsetWidth,s.removeClass("sliding-down").on("webkitTransitionEnd",a).addClass("sliding")}}).on("modal-close-click",function(o){if(o.preventDefault(),o.originalEvent.stop=!0,!i.mobility.busy){i.mobility.busy=!0;var e=t("modal-close-click",o.target),s=i(n(e)),a=function(){s.unbind("webkitTransitionEnd",a).removeClass("sliding").removeClass("sliding-down").addClass("hide"),i.mobility.busy=!1};s[0].offsetWidth,s.on("webkitTransitionEnd",a).addClass("sliding").addClass("sliding-down")}}).on("popover-open-click",function(o){o.preventDefault(),o.originalEvent.stop=!0;var e=t("popover-open-click",o.target),s=i(n(e));s.removeClass("hide")}).on("popover-close-click",function(o){o.preventDefault(),o.originalEvent.stop=!0;var e=t("popover-close-click",o.target),s=i(n(e));s.addClass("hide")}).on("notify-open-click",function(n){n.preventDefault(),n.originalEvent&&(n.originalEvent.stop=!0);var o=t("notify-open-click",n.target),e=o.attr("data-message"),s=o.attr("data-type");i.mobility.notify(e,s)}).on("notify-close-click",function(o){if(o.preventDefault(),o.originalEvent&&(o.originalEvent.stop=!0),!i.mobility.busy){i.mobility.busy=!0;var e=t("notify-close-click",o.target),s=i(n(e)),a=function(){s.remove(),i.mobility.busy=!1};s[0].offsetWidth,s.on("webkitTransitionEnd",a).addClass("sliding").addClass("sliding-up")}}).on("paginate-init",function(t,n){n=i(n);var o=n.parent(),e=function(){if(!i.mobility.busy){var t=-o.height();o.children().each(function(){t+=i(this).outerHeight()}),o.scrollTop()<.75*t||(i.mobility.busy=!0,i(window).trigger("mobility-paginate",[o,function(t){return i.mobility.busy=!1,t?void("boolean"!=typeof t&&n.html(n.attr("data-loading")).prev().append(i(t).css("opacity",0).animate({opacity:1}))):(n.html(n.attr("data-noresults")),void o.unbind("scroll",e))}]))}};o.scroll(e)}).on("refresh-pull-init",function(t,n){n=i(n),i("span.message",n).html(n.attr("data-pull"));var o=!1,e=n.parent(),s=function(){var t=e.scrollTop();if(181>t){var o=180-t;o>180?o=180:0>o&&(o=0),i("i",n).css("transform","rotate("+o+"deg)")}},a=function(){return 0==e.scrollTop()?o?(i("span.message",n).html(n.attr("data-release")),void i(window).one("touchend",d)):void d():void 0},l=function(){i("span.message",n).html()!==n.attr("data-release")&&e.scrollTop()<180&&(i.mobility.busy=!0,e.css("-webkit-overflow-scrolling","auto"),e.animate({scrollTop:180},"fast","swing",function(){e.css("-webkit-overflow-scrolling","touch"),i.mobility.busy=!1}))},d=function(){i.mobility.busy||(i("span.message",n).html(n.attr("data-loading")),i.mobility.busy=!0,n.animate({paddingTop:0,height:50},"fast",function(){i(window).trigger("mobility-refresh",[e,function(t){t&&n.next().prepend(i(t).css("opacity",0).animate({opacity:1})),n.css("padding-top","130px").css("height","180px"),i("span.message",n).html(n.attr("data-pull")),i("i",n).css("transform","rotate(0deg)"),e.scrollTop(179),setTimeout(function(){e.scrollTop(180)},5),i.mobility.busy=!1}])}))},r=function(){n.removeClass("hide"),e.scrollTop(180).on("scroll",s).on("scroll",a).on("touchend",l).on("touchstart",function(){o=!0}).on("touchend",function(){o=!1})};i.mobility.busy?i(window).one("mobility-swap-complete",r):r()}).on("hero-init",function(t,n){n=i(n);var o=function(){var t=0,o=0;n.on("mousedown touchstart",function(i){return i.originalEvent.touches?void(o=i.originalEvent.touches[0].pageX):void(o=i.pageX)}),n.on("mousemove touchmove",function(i){i.preventDefault()}),n.on("mouseup touchend touchcancel",function(i){var t;t=i.originalEvent.changedTouches?i.originalEvent.changedTouches[0].pageX-o:i.pageX-o,0>t?n.trigger("swipe-left"):t>0&&n.trigger("swipe-right")}),n.on("swipe-left",function(){var o=i("img",n).eq(++t);return o.length?(i("div.frame",n).animate({left:-1*o.position().left}),!1):void t--}).on("swipe-right",function(){var o=i("img",n).eq(--t);return!o.length||0>t?void t++:(i("div.frame",n).animate({left:-1*o.position().left}),!1)})};return i.mobility.busy?void i(window).on("mobility-swap-complete",o):void o()});var t=function(t,n){var o,e,s,a=null;if(n=i(n),n.attr("data-do")&&n.attr("data-on"))for(e=n.attr("data-do"),s=n.attr("data-on").split("|"),s.unshift("init"),o=0;o<s.length;o++)if(e+"-"+s[o]===t)return n;return n.parents("[data-do]").each(function(){if(a)return!1;for(e=i(this).attr("data-do"),s=i(this).attr("data-on").split("|"),s.unshift("init"),o=0;o<s.length;o++)if(e+"-"+s[o]===t)return a=i(this),!1}),a||n},n=function(t){t=i(t);var n=t.attr("data-target");return n&&n.length||(n=t.attr("href")),n},o='<div id="notify-{UID}" class="notify{TYPE}"><a data-do="notify-close" data-on="click" href="#notify-{UID}"><i class="fa fa-times"></i></a><span class="message">{MESSAGE}</span></div>';i.extend({mobility:{busy:!1,uid:0,notify:function(t,n){switch(i("div.notify").length&&i("div.notify > a").click(),n){case"info":case"warning":case"error":case"success":n=" notify-"+n;break;default:n=""}var e=o.replace("{UID}",++this.uid).replace("{UID}",this.uid).replace("{MESSAGE}",t).replace("{TYPE}",n);e=i(e).addClass("sliding-up"),i("section.current").append(e),setTimeout(function(){e.doon().removeClass("sliding-up").addClass("sliding")},1),setTimeout(function(){e.children("a").click()},3e3)},swap:function(t,n){if(!i.mobility.busy){i.mobility.busy=!0;var o=i('<section class="screen current">').html(t),e=i("section.screen.current"),s=function(){o.unbind("webkitTransitionEnd",s).removeClass("sliding").removeClass("sliding-up").removeClass("sliding-right").removeClass("sliding-down").removeClass("sliding-left"),e.remove(),i.mobility.busy=!1,i(window).trigger("mobility-swap-complete")},a=function(){e.remove(),i.mobility.busy=!1,i(window).trigger("mobility-swap-complete")};switch(n){case"slide-left":i(document.body).append(o),o.doon().addClass("sliding-right"),o[0].offsetWidth,o.removeClass("sliding-right").on("webkitTransitionEnd",s).addClass("sliding"),e.addClass("sliding").addClass("sliding-left");break;case"slide-right":i(document.body).append(o),o.doon().addClass("sliding-left"),o[0].offsetWidth,o.removeClass("sliding-left").on("webkitTransitionEnd",s).addClass("sliding"),e.addClass("sliding").addClass("sliding-right");break;case"slide-up":i(document.body).append(o),o.doon().addClass("sliding-down"),o[0].offsetWidth,o.removeClass("sliding-down").on("webkitTransitionEnd",s).addClass("sliding"),e.addClass("sliding").addClass("sliding-up");break;case"slide-down":i(document.body).append(o),o.doon().addClass("sliding-up"),o[0].offsetWidth,o.removeClass("sliding-up").on("webkitTransitionEnd",s).addClass("sliding"),e.addClass("sliding").addClass("sliding-down");break;case"fade":i(document.body).prepend(o),o.doon(),e.on("webkitTransitionEnd",a).addClass("fade");break;default:o.appendTo(document.body).doon(),e.remove(),i.mobility.busy=!1,i(window).trigger("mobility-swap-complete")}}},start:function(){i(document.body).doon()}}})}(jQuery);
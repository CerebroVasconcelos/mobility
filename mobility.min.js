/**
 * Mobility - Mobility is a super light weight HTML, 
 * CSS, and JS framework built on top of Bootstrap 
 * for developing mobile applications. 
 *
 * @version 0.0.1
 * @author Christian Blanquera <cblanquera@openovate.com>
 * @website https://github.com/cblanquera/mobility
 * @license MIT
 */
!function(i){i(window).on("go-back-click",function(s){s.preventDefault(),s.originalEvent.stop=!0;var a=t("go-back-click",s.target),e=n(a);try{i(e).length&&i(e).html()&&i.mobility.swap(i(e).html(),"slide-right")}catch(s){}i(window).trigger("mobility-request",[e,"slide-right"])}).on("go-forward-click",function(s){s.preventDefault(),s.originalEvent.stop=!0;var a=t("go-back-click",s.target),e=n(a);try{i(e).length&&i(e).html()&&i.mobility.swap(i(e).html(),"slide-left")}catch(s){}i(window).trigger("mobility-request",[e,"slide-left"])}).on("focus-input-group-init",function(t,n){n=i(n),n.find("label").each(function(){i(this).click(function(){n.find("label input").each(function(){this.checked?i(this).parents("label:first").addClass("active"):i(this).parents("label:first").removeClass("active")})})})}).on("tab-switch-click",function(s){s.preventDefault(),s.originalEvent.stop=!0;var a=t("tab-switch-click",s.target),e=i(n(a));a.siblings().each(function(){var t=i(this).removeClass("active").attr("href");i(t).addClass("hide")}),a.addClass("active"),e.removeClass("hide")}).on("modal-open-click",function(s){if(s.preventDefault(),s.originalEvent.stop=!0,!i.mobility.busy){i.mobility.busy=!0;var a=t("modal-open-click",s.target),e=i(n(a)),o=function(){e.unbind("webkitTransitionEnd",o).removeClass("sliding"),i.mobility.busy=!1};e.addClass("sliding-down").removeClass("hide"),e[0].offsetWidth,e.removeClass("sliding-down").on("webkitTransitionEnd",o).addClass("sliding")}}).on("modal-close-click",function(s){if(s.preventDefault(),s.originalEvent.stop=!0,!i.mobility.busy){i.mobility.busy=!0;var a=t("modal-close-click",s.target),e=i(n(a)),o=function(){e.unbind("webkitTransitionEnd",o).removeClass("sliding").removeClass("sliding-down").addClass("hide"),i.mobility.busy=!1};e[0].offsetWidth,e.on("webkitTransitionEnd",o).addClass("sliding").addClass("sliding-down")}}).on("popover-open-click",function(s){s.preventDefault(),s.originalEvent.stop=!0;var a=t("popover-open-click",s.target),e=i(n(a));e.removeClass("hide")}).on("popover-close-click",function(s){s.preventDefault(),s.originalEvent.stop=!0;var a=t("popover-close-click",s.target),e=i(n(a));e.addClass("hide")}).on("refresh-pull-init",function(t,n){n=i(n),i("span.message",n).html(n.attr("data-pull"));var s=n.parent(),a="normal";s.scrollTop(1).scroll(function(){if("loading"===a)return void s.scrollTop(0);var t=s.scrollTop();return 0===t&&"normal"===a?(n.removeClass("hide"),s.scrollTop(180),void(a="pull")):"pull"===a&&t>180?(n.addClass("hide"),s.scrollTop(1),void(a="normal")):"pull"===a?(i("i",n).css("transform","rotate("+(180-t)+"deg)"),void(0===t&&(i("span.message",n).html(n.attr("data-loading")),a="loading",n.animate({paddingTop:0,height:50},"fast",function(){i(window).trigger("mobility-refresh",[s,function(t){t&&n.next().prepend(i(t).css("opacity",0).animate({opacity:1})),n.animate({height:0},"fast",function(){n.addClass("hide").css("padding-top","130px").css("height","180px"),i("span.message",n).html(n.attr("data-pull")),i("i",n).css("transform","rotate(0deg)"),setTimeout(function(){a="normal",s.scrollTop(1)},200)})}])})))):void 0})});var t=function(t,n){var s,a,e,o=null;if(n=i(n),n.attr("data-do")&&n.attr("data-on"))for(a=n.attr("data-do"),e=n.attr("data-on").split("|"),e.unshift("init"),s=0;s<e.length;s++)if(a+"-"+e[s]===t)return n;return n.parents("[data-do]").each(function(){if(o)return!1;for(a=i(this).attr("data-do"),e=i(this).attr("data-on").split("|"),e.unshift("init"),s=0;s<e.length;s++)if(a+"-"+e[s]===t)return o=i(this),!1}),o||n},n=function(t){t=i(t);var n=t.attr("data-target");return n&&n.length||(n=t.attr("href")),n};i.extend({mobility:{busy:!1,swap:function(t,n){if(!i.mobility.busy){i.mobility.busy=!0;var s=i('<section class="screen current">').html(t),a=i("section.screen.current"),e=function(){s.unbind("webkitTransitionEnd",e).removeClass("sliding").removeClass("sliding-up").removeClass("sliding-right").removeClass("sliding-down").removeClass("sliding-left"),a.remove(),i.mobility.busy=!1},o=function(){a.remove(),i.mobility.busy=!1};switch(n){case"slide-left":i(document.body).append(s),s.doon().addClass("sliding-right"),s[0].offsetWidth,s.removeClass("sliding-right").on("webkitTransitionEnd",e).addClass("sliding"),a.addClass("sliding").addClass("sliding-left");break;case"slide-right":i(document.body).append(s),s.doon().addClass("sliding-left"),s[0].offsetWidth,s.removeClass("sliding-left").on("webkitTransitionEnd",e).addClass("sliding"),a.addClass("sliding").addClass("sliding-right");break;case"slide-up":i(document.body).append(s),s.doon().addClass("sliding-down"),s[0].offsetWidth,s.removeClass("sliding-down").on("webkitTransitionEnd",e).addClass("sliding"),a.addClass("sliding").addClass("sliding-up");break;case"slide-down":i(document.body).append(s),s.doon().addClass("sliding-up"),s[0].offsetWidth,s.removeClass("sliding-up").on("webkitTransitionEnd",e).addClass("sliding"),a.addClass("sliding").addClass("sliding-down");break;case"fade":i(document.body).prepend(s),s.doon(),a.on("webkitTransitionEnd",o).addClass("fade");break;default:s.appendTo(document.body).doon(),a.remove(),i.mobility.busy=!1}}},start:function(){i(document.body).doon()}}})}(jQuery);